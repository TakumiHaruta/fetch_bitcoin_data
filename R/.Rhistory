bc_se_2 <- apply(bc[bc$phase==2,2:7], 2, se)
bc_se_3 <- apply(bc[bc$phase==3,2:7], 2, se)
bc_stats <- t(data.frame(bc_mean_1=bc_mean_1, bc_mean_2=bc_mean_2, bc_mean_3=bc_mean_3, bc_median_1=bc_median_1, bc_median_2=bc_median_2, bc_median_3=bc_median_3, bc_se_1=bc_se_1, bc_se_2=bc_se_2, bc_se_3=bc_se_3))
write.table(bc_stats, "bc_stats.csv", sep=",")
w_kable_styling(kable(bc_stats, caption="bc_stats"))
bcd_mean_1 <- apply(bcd[bcd$phase==1,2:7], 2, mean)
bcd_mean_2 <- apply(bcd[bcd$phase==2,2:7], 2, mean)
bcd_mean_3 <- apply(bcd[bcd$phase==3,2:7], 2, mean)
bcd_median_1 <- apply(bcd[bcd$phase==1,2:7], 2, median)
bcd_median_2 <- apply(bcd[bcd$phase==2,2:7], 2, median)
bcd_median_3 <- apply(bcd[bcd$phase==3,2:7], 2, median)
bcd_se_1 <- apply(bcd[bcd$phase==1,2:7], 2, se)
bcd_se_2 <- apply(bcd[bcd$phase==2,2:7], 2, se)
bcd_se_3 <- apply(bcd[bcd$phase==3,2:7], 2, se)
bcd_stats <- t(data.frame(bcd_mean_1=bcd_mean_1, bcd_mean_2=bcd_mean_2, bcd_mean_3=bcd_mean_3, bcd_median_1=bcd_median_1, bcd_median_2=bcd_median_2, bcd_median_3=bcd_median_3, bcd_se_1=bcd_se_1, bcd_se_2=bcd_se_2, bcd_se_3=bcd_se_3))
write.table(bcd_stats, "bcd_stats.csv", sep=",")
w_kable_styling(kable(bcd_stats, caption="bcd_stats"))
psych::pairs.panels(bc[bc$phase==1,2:7], method="spearman")
psych::pairs.panels(bc[bc$phase==2,2:7], method="spearman")
psych::pairs.panels(bc[bc$phase==3,2:7], method="spearman")
psych::pairs.panels(bcd[bcd$phase==1,2:7], method="spearman")
psych::pairs.panels(bcd[bcd$phase==2,2:7], method="spearman")
psych::pairs.panels(bcd[bcd$phase==3,2:7], method="spearman")
acf(bc[bc$phase==1,]$mkpru, lag.max=20, main="RAW newbc")
acf(bc[bc$phase==2,]$mkpru, lag.max=20, main="RAW newbc")
acf(bc[bc$phase==3,]$mkpru, lag.max=20, main="RAW newbc")
acf(bcd[bcd$phase==1,]$dmkpru, lag.max=20, main="DIFF newbc")
acf(bcd[bcd$phase==2,]$dmkpru, lag.max=20, main="DIFF newbc")
acf(bcd[bcd$phase==3,]$dmkpru, lag.max=20, main="DIFF newbc")
acf(bc[bc$phase==1,]$ntran, lag.max=20)
acf(bc[bc$phase==2,]$ntran, lag.max=20)
acf(bc[bc$phase==3,]$ntran, lag.max=20)
acf(bcd[bcd$phase==1,]$dntran, lag.max=20)
acf(bcd[bcd$phase==2,]$dntran, lag.max=20)
acf(bcd[bcd$phase==3,]$dntran, lag.max=20)
acf(bc[bc$phase==1,]$naddu, lag.max=20)
acf(bc[bc$phase==2,]$naddu, lag.max=20)
acf(bc[bc$phase==3,]$naddu, lag.max=20)
acf(bcd[bcd$phase==1,]$dnaddu, lag.max=20)
acf(bcd[bcd$phase==2,]$dnaddu, lag.max=20)
acf(bcd[bcd$phase==3,]$dnaddu, lag.max=20)
acf(bc[bc$phase==1,]$atrct, lag.max=20)
acf(bc[bc$phase==2,]$atrct, lag.max=20)
acf(bc[bc$phase==3,]$atrct, lag.max=20)
acf(bcd[bcd$phase==1,]$datrct, lag.max=20)
acf(bcd[bcd$phase==2,]$datrct, lag.max=20)
acf(bcd[bcd$phase==3,]$datrct, lag.max=20)
acf(bc[bc$phase==1,]$trfee, lag.max=20)
acf(bc[bc$phase==2,]$trfee, lag.max=20)
acf(bc[bc$phase==3,]$trfee, lag.max=20)
acf(bcd[bcd$phase==1,]$dtrfee, lag.max=20)
acf(bcd[bcd$phase==2,]$dtrfee, lag.max=20)
acf(bcd[bcd$phase==3,]$dtrfee, lag.max=20)
acf(bc[bc$phase==1,]$hrate, lag.max=20)
acf(bc[bc$phase==2,]$hrate, lag.max=20)
acf(bc[bc$phase==3,]$hrate, lag.max=20)
acf(bcd[bcd$phase==1,]$dhrate, lag.max=20)
acf(bcd[bcd$phase==2,]$dhrate, lag.max=20)
acf(bcd[bcd$phase==3,]$dhrate, lag.max=20)
st_mkpru <- st(bc[bc$phase==1,]$mkpru)
st_ntran <- st(bc[bc$phase==1,]$ntran)
st_naddu <- st(bc[bc$phase==1,]$naddu)
st_atrct <- st(bc[bc$phase==1,]$atrct)
st_trfee <- st(bc[bc$phase==1,]$trfee)
st_hrate <- st(bc[bc$phase==1,]$hrate)
pv_mkpru <- pv(bc[bc$phase==1,]$mkpru)
pv_ntran <- pv(bc[bc$phase==1,]$ntran)
pv_naddu <- pv(bc[bc$phase==1,]$naddu)
pv_atrct <- pv(bc[bc$phase==1,]$atrct)
pv_trfee <- pv(bc[bc$phase==1,]$trfee)
pv_hrate <- pv(bc[bc$phase==1,]$hrate)
ljung_box <- t(data.frame(
"Qm mkpru"=st_mkpru,
"pvalue mkpru"=pv_mkpru,
"Qm ntran"=st_ntran,
"pvalue ntran"=pv_ntran,
"Qm naddu"=st_naddu,
"pvalue naddu"=pv_naddu,
"Qm atrct"=st_atrct,
"pvalue atrct"=pv_atrct,
"Qm trfee"=st_trfee,
"pvalue trfee"=pv_trfee,
"Qm hrate"=st_hrate,
"pvalue hrate"=pv_hrate
))
write.table(ljung_box, "ljung_box_raw_phase1.csv", sep=",")
w_kable_styling(kable(ljung_box, caption="Ljung-Box Raw Phase 1"))
st_mkpru <- st(bc[bc$phase==2,]$mkpru)
st_ntran <- st(bc[bc$phase==2,]$ntran)
st_naddu <- st(bc[bc$phase==2,]$naddu)
st_atrct <- st(bc[bc$phase==2,]$atrct)
st_trfee <- st(bc[bc$phase==2,]$trfee)
st_hrate <- st(bc[bc$phase==2,]$hrate)
pv_mkpru <- pv(bc[bc$phase==2,]$mkpru)
pv_ntran <- pv(bc[bc$phase==2,]$ntran)
pv_naddu <- pv(bc[bc$phase==2,]$naddu)
pv_atrct <- pv(bc[bc$phase==2,]$atrct)
pv_trfee <- pv(bc[bc$phase==2,]$trfee)
pv_hrate <- pv(bc[bc$phase==2,]$hrate)
ljung_box <- t(data.frame(
"Qm mkpru"=st_mkpru,
"pvalue mkpru"=pv_mkpru,
"Qm ntran"=st_ntran,
"pvalue ntran"=pv_ntran,
"Qm naddu"=st_naddu,
"pvalue naddu"=pv_naddu,
"Qm atrct"=st_atrct,
"pvalue atrct"=pv_atrct,
"Qm trfee"=st_trfee,
"pvalue trfee"=pv_trfee,
"Qm hrate"=st_hrate,
"pvalue hrate"=pv_hrate
))
write.table(ljung_box, "ljung_box_raw_phase2.csv", sep=",")
w_kable_styling(kable(ljung_box, caption="Ljung-Box Raw Phase 2"))
st_mkpru <- st(bc[bc$phase==3,]$mkpru)
st_ntran <- st(bc[bc$phase==3,]$ntran)
st_naddu <- st(bc[bc$phase==3,]$naddu)
st_atrct <- st(bc[bc$phase==3,]$atrct)
st_trfee <- st(bc[bc$phase==3,]$trfee)
st_hrate <- st(bc[bc$phase==3,]$hrate)
pv_mkpru <- pv(bc[bc$phase==3,]$mkpru)
pv_ntran <- pv(bc[bc$phase==3,]$ntran)
pv_naddu <- pv(bc[bc$phase==3,]$naddu)
pv_atrct <- pv(bc[bc$phase==3,]$atrct)
pv_trfee <- pv(bc[bc$phase==3,]$trfee)
pv_hrate <- pv(bc[bc$phase==3,]$hrate)
ljung_box <- t(data.frame(
"Qm mkpru"=st_mkpru,
"pvalue mkpru"=pv_mkpru,
"Qm ntran"=st_ntran,
"pvalue ntran"=pv_ntran,
"Qm naddu"=st_naddu,
"pvalue naddu"=pv_naddu,
"Qm atrct"=st_atrct,
"pvalue atrct"=pv_atrct,
"Qm trfee"=st_trfee,
"pvalue trfee"=pv_trfee,
"Qm hrate"=st_hrate,
"pvalue hrate"=pv_hrate
))
write.table(ljung_box, "ljung_box_raw_phase3.csv", sep=",")
w_kable_styling(kable(ljung_box, caption="Ljung-Box Raw Phase 3"))
st_mkpru <- st(bcd[bcd$phase==1,]$dmkpru)
st_ntran <- st(bcd[bcd$phase==1,]$dntran)
st_naddu <- st(bcd[bcd$phase==1,]$dnaddu)
st_atrct <- st(bcd[bcd$phase==1,]$datrct)
st_trfee <- st(bcd[bcd$phase==1,]$dtrfee)
st_hrate <- st(bcd[bcd$phase==1,]$dhrate)
pv_mkpru <- pv(bcd[bcd$phase==1,]$dmkpru)
pv_ntran <- pv(bcd[bcd$phase==1,]$dntran)
pv_naddu <- pv(bcd[bcd$phase==1,]$dnaddu)
pv_atrct <- pv(bcd[bcd$phase==1,]$datrct)
pv_trfee <- pv(bcd[bcd$phase==1,]$dtrfee)
pv_hrate <- pv(bcd[bcd$phase==1,]$dhrate)
ljung_box <- t(data.frame(
"Qm mkpru"=st_mkpru,
"pvalue mkpru"=pv_mkpru,
"Qm ntran"=st_ntran,
"pvalue ntran"=pv_ntran,
"Qm naddu"=st_naddu,
"pvalue naddu"=pv_naddu,
"Qm atrct"=st_atrct,
"pvalue atrct"=pv_atrct,
"Qm trfee"=st_trfee,
"pvalue trfee"=pv_trfee,
"Qm hrate"=st_hrate,
"pvalue hrate"=pv_hrate
))
write.table(ljung_box, "ljung_box_diff_phase1.csv", sep=",")
w_kable_styling(kable(ljung_box, caption="Ljung-Box hrate Phase 1"))
st_mkpru <- st(bcd[bcd$phase==2,]$dmkpru)
st_ntran <- st(bcd[bcd$phase==2,]$dntran)
st_naddu <- st(bcd[bcd$phase==2,]$dnaddu)
st_atrct <- st(bcd[bcd$phase==2,]$datrct)
st_trfee <- st(bcd[bcd$phase==2,]$dtrfee)
st_hrate <- st(bcd[bcd$phase==2,]$dhrate)
pv_mkpru <- pv(bcd[bcd$phase==2,]$dmkpru)
pv_ntran <- pv(bcd[bcd$phase==2,]$dntran)
pv_naddu <- pv(bcd[bcd$phase==2,]$dnaddu)
pv_atrct <- pv(bcd[bcd$phase==2,]$datrct)
pv_trfee <- pv(bcd[bcd$phase==2,]$dtrfee)
pv_hrate <- pv(bcd[bcd$phase==2,]$dhrate)
ljung_box <- t(data.frame(
"Qm mkpru"=st_mkpru,
"pvalue mkpru"=pv_mkpru,
"Qm ntran"=st_ntran,
"pvalue ntran"=pv_ntran,
"Qm naddu"=st_naddu,
"pvalue naddu"=pv_naddu,
"Qm atrct"=st_atrct,
"pvalue atrct"=pv_atrct,
"Qm trfee"=st_trfee,
"pvalue trfee"=pv_trfee,
"Qm hrate"=st_hrate,
"pvalue hrate"=pv_hrate
))
write.table(ljung_box, "ljung_box_diff_phase2.csv", sep=",")
w_kable_styling(kable(ljung_box, caption="Ljung-Box hrate Phase 2"))
st_mkpru <- st(bcd[bcd$phase==3,]$dmkpru)
st_ntran <- st(bcd[bcd$phase==3,]$dntran)
st_naddu <- st(bcd[bcd$phase==3,]$dnaddu)
st_atrct <- st(bcd[bcd$phase==3,]$datrct)
st_trfee <- st(bcd[bcd$phase==3,]$dtrfee)
st_hrate <- st(bcd[bcd$phase==3,]$dhrate)
pv_mkpru <- pv(bcd[bcd$phase==3,]$dmkpru)
pv_ntran <- pv(bcd[bcd$phase==3,]$dntran)
pv_naddu <- pv(bcd[bcd$phase==3,]$dnaddu)
pv_atrct <- pv(bcd[bcd$phase==3,]$datrct)
pv_trfee <- pv(bcd[bcd$phase==3,]$dtrfee)
pv_hrate <- pv(bcd[bcd$phase==3,]$dhrate)
ljung_box <- t(data.frame(
"Qm mkpru"=st_mkpru,
"pvalue mkpru"=pv_mkpru,
"Qm ntran"=st_ntran,
"pvalue ntran"=pv_ntran,
"Qm naddu"=st_naddu,
"pvalue naddu"=pv_naddu,
"Qm atrct"=st_atrct,
"pvalue atrct"=pv_atrct,
"Qm trfee"=st_trfee,
"pvalue trfee"=pv_trfee,
"Qm hrate"=st_hrate,
"pvalue hrate"=pv_hrate
))
write.table(ljung_box, "ljung_box_diff_phase3.csv", sep=",")
w_kable_styling(kable(ljung_box, caption="Ljung-Box hrate Phase 3"))
#adftest <- ur.df(bc[bc$phase==1,]$newbc, type=c("none", "drift", "trend"), lags=8, selectlags=c("AIC", "BIC"))
adf_aic <- ur.df(bc[bc$phase==1,]$mkpru, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==1,]$mkpru, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==2,]$mkpru, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==2,]$mkpru, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==3,]$mkpru, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==3,]$mkpru, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_mkpru <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_mkpru) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_mkpru, "adf_mkpru.csv", sep=",")
w_kable_styling(kable(adf_mkpru, caption="adf_mkpru"))
adf_aic <- ur.df(bc[bc$phase==1,]$ntran, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==1,]$ntran, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==2,]$ntran, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==2,]$ntran, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==3,]$ntran, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==3,]$ntran, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_ntran <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_ntran) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_ntran, "adf_ntran.csv", sep=",")
w_kable_styling(kable(adf_ntran, caption="adf_ntran"))
adf_aic <- ur.df(bc[bc$phase==1,]$naddu, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==1,]$naddu, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==2,]$naddu, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==2,]$naddu, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==3,]$naddu, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==3,]$naddu, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_naddu <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_naddu) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_naddu, "adf_naddu.csv", sep=",")
w_kable_styling(kable(adf_naddu, caption="adf_naddu"))
adf_aic <- ur.df(bc[bc$phase==1,]$atrct, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==1,]$atrct, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==2,]$atrct, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==2,]$atrct, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==3,]$atrct, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==3,]$atrct, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_atrct <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_atrct) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_atrct, "adf_atrct.csv", sep=",")
w_kable_styling(kable(adf_atrct, caption="adf_atrct"))
adf_aic <- ur.df(bc[bc$phase==1,]$trfee, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==1,]$trfee, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==2,]$trfee, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==2,]$trfee, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==3,]$trfee, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==3,]$trfee, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_trfee <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_trfee) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_trfee, "adf_trfee.csv", sep=",")
w_kable_styling(kable(adf_trfee, caption="adf_trfee"))
adf_aic <- ur.df(bc[bc$phase==1,]$hrate, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==1,]$hrate, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==2,]$hrate, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==2,]$hrate, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bc[bc$phase==3,]$hrate, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bc[bc$phase==3,]$hrate, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_hrate <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_hrate) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_hrate, "adf_hrate.csv", sep=",")
w_kable_styling(kable(adf_hrate, caption="adf_hrate"))
#adftest <- ur.df(bcd[bcd$phase==1,]$dnewbc, type=c("none", "drift", "trend"), lags=8, selectlags=c("AIC", "BIC"))
adf_aic <- ur.df(bcd[bcd$phase==1,]$dmkpru, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==1,]$dmkpru, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==2,]$dmkpru, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==2,]$dmkpru, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==3,]$dmkpru, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==3,]$dmkpru, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_mkpru <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_mkpru) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_mkpru, "adf_mkpru.csv", sep=",")
w_kable_styling(kable(adf_mkpru, caption="adf_mkpru"))
adf_aic <- ur.df(bcd[bcd$phase==1,]$dntran, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==1,]$dntran, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==2,]$dntran, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==2,]$dntran, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==3,]$dntran, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==3,]$dntran, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_ntran <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_ntran) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_ntran, "adf_ntran.csv", sep=",")
w_kable_styling(kable(adf_ntran, caption="adf_ntran"))
adf_aic <- ur.df(bcd[bcd$phase==1,]$dnaddu, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==1,]$dnaddu, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==2,]$dnaddu, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==2,]$dnaddu, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==3,]$dnaddu, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==3,]$dnaddu, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_naddu <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_naddu) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_naddu, "adf_naddu.csv", sep=",")
w_kable_styling(kable(adf_naddu, caption="adf_naddu"))
adf_aic <- ur.df(bcd[bcd$phase==1,]$datrct, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==1,]$datrct, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==2,]$datrct, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==2,]$datrct, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==3,]$datrct, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==3,]$datrct, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_atrct <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_atrct) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_atrct, "adf_atrct.csv", sep=",")
w_kable_styling(kable(adf_atrct, caption="adf_atrct"))
adf_aic <- ur.df(bcd[bcd$phase==1,]$dtrfee, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==1,]$dtrfee, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==2,]$dtrfee, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==2,]$dtrfee, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==3,]$dtrfee, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==3,]$dtrfee, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_trfee <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_trfee) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_trfee, "adf_trfee.csv", sep=",")
w_kable_styling(kable(adf_trfee, caption="adf_trfee"))
adf_aic <- ur.df(bcd[bcd$phase==1,]$dhrate, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==1,]$dhrate, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p1 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==2,]$dhrate, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==2,]$dhrate, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p2 <- rbind(adf_aic, adf_bic)
adf_aic <- ur.df(bcd[bcd$phase==3,]$dhrate, type=c("trend"), lags=8, selectlags=c("AIC"))
adf_bic <- ur.df(bcd[bcd$phase==3,]$dhrate, type=c("trend"), lags=8, selectlags=c("BIC"))
adf_aic <- cbind(t(summary(adf_aic)@teststat), summary(adf_aic)@cval)
adf_bic <- cbind(t(summary(adf_bic)@teststat), summary(adf_bic)@cval)
adf_p3 <- rbind(adf_aic, adf_bic)
adf_hrate <- rbind(adf_p1, adf_p2, adf_p3)
rownames(adf_hrate) <- c("p1_aic_tau3", "p1_aic_phi2", "p1_aic_phi3", "p1_bic_tau3", "p1_bic_phi2", "p1_bic_phi3", "p2_aic_tau3", "p2_aic_phi2", "p2_aic_phi3", "p2_bic_tau3", "p2_bic_phi2",  "p2_bic_phi3","p3_aic_tau3", "p3_aic_phi2", "p3_aic_phi3", "p3_bic_tau3", "p3_bic_phi2", "p3_bic_phi3")
write.table(adf_hrate, "adf_hrate.csv", sep=",")
w_kable_styling(kable(adf_hrate, caption="adf_hrate"))
ic_1 <- VARselect(bcd[bcd$phase==1,2:7], lag.max = 8)[1]
ic_2 <- VARselect(bcd[bcd$phase==2,2:7], lag.max = 8)[1]
ic_3 <- VARselect(bcd[bcd$phase==3,2:7], lag.max = 8)[1]
ic <- data.frame(c(Phase_1=ic_1, Phase_2=ic_2, Phase_3=ic_3))
write.table(ic, "IC.csv", sep=",")
ic
trace_aic <- ca.jo(bc[bc$phase==1,2:7], ecdet="trend", type="trace", K=8)
trace_bic <- ca.jo(bc[bc$phase==1,2:7], ecdet="trend", type="trace", K=5)
trace_aic <- cbind(t(t(summary(trace_aic)@teststat)), summary(trace_aic)@cval)
trace_bic <- cbind(t(t(summary(trace_bic)@teststat)), summary(trace_bic)@cval)
trace_p1 <- rbind(trace_aic, trace_bic)
write.table(trace_p1, "trace_p1.csv", sep=",")
w_kable_styling(kable(trace_p1, caption="trace_p1"))
trace_aic <- ca.jo(bc[bc$phase==2,2:7], ecdet="trend", type="trace", K=8)
trace_bic <- ca.jo(bc[bc$phase==2,2:7], ecdet="trend", type="trace", K=6)
trace_aic <- cbind(t(t(summary(trace_aic)@teststat)), summary(trace_aic)@cval)
trace_bic <- cbind(t(t(summary(trace_bic)@teststat)), summary(trace_bic)@cval)
trace_p2 <- rbind(trace_aic, trace_bic)
write.table(trace_p2, "trace_p2.csv", sep=",")
w_kable_styling(kable(trace_p2, caption="trace_p2"))
trace_aic <- ca.jo(bc[bc$phase==3,2:7], ecdet="trend", type="trace", K=8)
trace_bic <- ca.jo(bc[bc$phase==3,2:7], ecdet="trend", type="trace", K=6)
trace_aic <- cbind(t(t(summary(trace_aic)@teststat)), summary(trace_aic)@cval)
trace_bic <- cbind(t(t(summary(trace_bic)@teststat)), summary(trace_bic)@cval)
trace_p3 <- rbind(trace_aic, trace_bic)
write.table(trace_p3, "trace_p3.csv", sep=",")
w_kable_styling(kable(trace_p3, caption="trace_p3"))
eigen_aic <- ca.jo(bc[bc$phase==1,2:7], ecdet="trend", type="eigen", K=8)
eigen_bic <- ca.jo(bc[bc$phase==1,2:7], ecdet="trend", type="eigen", K=5)
eigen_aic <- cbind(t(t(summary(eigen_aic)@teststat)), summary(eigen_aic)@cval)
eigen_bic <- cbind(t(t(summary(eigen_bic)@teststat)), summary(eigen_bic)@cval)
eigen_p1 <- rbind(eigen_aic, eigen_bic)
write.table(eigen_p1, "eigen_p1.csv", sep=",")
w_kable_styling(kable(eigen_p1, caption="eigen_p1"))
eigen_aic <- ca.jo(bc[bc$phase==2,2:7], ecdet="trend", type="eigen", K=8)
eigen_bic <- ca.jo(bc[bc$phase==2,2:7], ecdet="trend", type="eigen", K=6)
eigen_aic <- cbind(t(t(summary(eigen_aic)@teststat)), summary(eigen_aic)@cval)
eigen_bic <- cbind(t(t(summary(eigen_bic)@teststat)), summary(eigen_bic)@cval)
eigen_p2 <- rbind(eigen_aic, eigen_bic)
write.table(eigen_p2, "eigen_p2.csv", sep=",")
w_kable_styling(kable(eigen_p2, caption="eigen_p2"))
eigen_aic <- ca.jo(bc[bc$phase==3,2:7], ecdet="trend", type="eigen", K=8)
eigen_bic <- ca.jo(bc[bc$phase==3,2:7], ecdet="trend", type="eigen", K=6)
eigen_aic <- cbind(t(t(summary(eigen_aic)@teststat)), summary(eigen_aic)@cval)
eigen_bic <- cbind(t(t(summary(eigen_bic)@teststat)), summary(eigen_bic)@cval)
eigen_p3 <- rbind(eigen_aic, eigen_bic)
write.table(eigen_p3, "eigen_p3.csv", sep=",")
w_kable_styling(kable(eigen_p3, caption="eigen_p3"))
var.p1 <- VAR(bc[bc$phase==1,2:7], p=8)
var.p2 <- VAR(bc[bc$phase==2,2:7], p=8)
var.p3 <- VAR(bc[bc$phase==3,2:7], p=8)
irf.p1 <- irf(var.p1, n.ahead=7, ci=0.95)
irf.p2 <- irf(var.p2, n.ahead=7, ci=0.95)
irf.p3 <- irf(var.p3, n.ahead=7, ci=0.95)
plot(irf.p1)
