---
title: "Bitcoin 時系列分析 DID"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(RPostgreSQL)
library(tseries)
library(xts)
library(zoo)
library(knitr)
library(kableExtra)
library(vars)
drv <- dbDriver("PostgreSQL")
con <- dbConnect(drv,dbname="bitcoin",host="localhost",port=5432,user="takumi",password="takumi")
options(digits=5)
options(scipen=20)
w_adf.test <- function(x) { return(suppressWarnings(adf.test(x))) }
w_kable_styling <- function(x) { return(kable_styling(x, bootstrap_options = c("striped", "hover"))) }
```

```{r read_table}
bc <- dbReadTable(con,"bitcoin_raw")
bcl <- dbReadTable(con,"bitcoin_log")
bcd <- dbReadTable(con,"bitcoin_diff")[-1,]
bcdl <- dbReadTable(con,"bitcoin_log_diff")[-1,]
```

## Bitcoin データ外観
LOG -> 0のデータがあるため、+1して算出  

phaseによる差はmkpruで自己相関検定が棄却できないことぐらい  

### Total Number of Transactions Per Day

The number of daily confirmed Bitcoin transactions  
https://www.blockchain.com/charts/n-transactions  

```{r Total Number of Transactions Per Day, echo=FALSE}
acf(bc[bc$phase==1,]$ntran, lag.max=30)
acf(bc[bc$phase==2,]$ntran, lag.max=30)
acf(bc[bc$phase==3,]$ntran, lag.max=30)
acf(bcl[bcl$phase==1,]$lntran, lag.max=30)
acf(bcl[bcl$phase==2,]$lntran, lag.max=30)
acf(bcl[bcl$phase==3,]$lntran, lag.max=30)
acf(bcd[bcd$phase==1,]$dntran, lag.max=30)
acf(bcd[bcd$phase==2,]$dntran, lag.max=30)
acf(bcd[bcd$phase==3,]$dntran, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dlntran, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dlntran, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dlntran, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dlntran, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dlntran, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dlntran, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dlntran, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dlntran, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dlntran, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$ntran)[[1]], w_adf.test(bcl[bcl$phase==1,]$lntran)[[1]], w_adf.test(bcd[bcd$phase==1,]$dntran)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dlntran)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$ntran)[[1]], w_adf.test(bcl[bcl$phase==2,]$lntran)[[1]], w_adf.test(bcd[bcd$phase==2,]$dntran)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dlntran)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$ntran)[[1]], w_adf.test(bcl[bcl$phase==3,]$lntran)[[1]], w_adf.test(bcd[bcd$phase==3,]$dntran)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dlntran)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$ntran)[[4]], w_adf.test(bcl[bcl$phase==1,]$lntran)[[4]], w_adf.test(bcd[bcd$phase==1,]$dntran)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dlntran)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$ntran)[[4]], w_adf.test(bcl[bcl$phase==2,]$lntran)[[4]], w_adf.test(bcd[bcd$phase==2,]$dntran)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dlntran)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$ntran)[[4]], w_adf.test(bcl[bcl$phase==3,]$lntran)[[4]], w_adf.test(bcd[bcd$phase==3,]$dntran)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dlntran)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```

### Daily Exchange Transaction Volume


```{r Daily Exchange Transaction Volume, echo=FALSE}
bc_om_1 <- na.omit(bc[bc$phase==1,]$exch)
bc_om_2 <- na.omit(bc[bc$phase==2,]$exch)
bc_om_3 <- na.omit(bc[bc$phase==3,]$exch)
bcl_om_1 <- na.omit(bcl[bcl$phase==1,]$lexch)
bcl_om_2 <- na.omit(bcl[bcl$phase==2,]$lexch)
bcl_om_3 <- na.omit(bcl[bcl$phase==3,]$lexch)
bcd_om_1 <- na.omit(bcd[bcd$phase==1,]$dexch)
bcd_om_2 <- na.omit(bcd[bcd$phase==2,]$dexch)
bcd_om_3 <- na.omit(bcd[bcd$phase==3,]$dexch)
bcdl_om_1 <- na.omit(bcdl[bcdl$phase==1,]$dlexch)
bcdl_om_2 <- na.omit(bcdl[bcdl$phase==2,]$dlexch)
bcdl_om_3 <- na.omit(bcdl[bcdl$phase==3,]$dlexch)

acf(bc_om_1, lag.max=30)
acf(bc_om_2, lag.max=30)
acf(bc_om_3, lag.max=30)
acf(bcl_om_1, lag.max=30)
acf(bcl_om_2, lag.max=30)
acf(bcl_om_3, lag.max=30)
acf(bcd_om_1, lag.max=30)
acf(bcd_om_2, lag.max=30)
acf(bcd_om_3, lag.max=30)
acf(bcdl_om_1, lag.max=30)
acf(bcdl_om_2, lag.max=30)
acf(bcdl_om_3, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl_om_1, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl_om_2, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl_om_3, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl_om_1, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl_om_2, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl_om_3, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc_om_1)[[1]], w_adf.test(bcl_om_1)[[1]], w_adf.test(bcd_om_1)[[1]], w_adf.test(bcdl_om_1)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc_om_2)[[1]], w_adf.test(bcl_om_2)[[1]], w_adf.test(bcd_om_2)[[1]], w_adf.test(bcdl_om_2)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc_om_3)[[1]], w_adf.test(bcl_om_3)[[1]], w_adf.test(bcd_om_3)[[1]], w_adf.test(bcdl_om_3)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc_om_1)[[4]], w_adf.test(bcl_om_1)[[4]], w_adf.test(bcd_om_1)[[4]], w_adf.test(bcdl_om_1)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc_om_2)[[4]], w_adf.test(bcl_om_2)[[4]], w_adf.test(bcd_om_2)[[4]], w_adf.test(bcdl_om_2)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc_om_3)[[4]], w_adf.test(bcl_om_3)[[4]], w_adf.test(bcd_om_3)[[4]], w_adf.test(bcdl_om_3)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```


### Estimated Transaction Value

The total estimated value of transactions on the Bitcoin blockchain (does not include coins returned to sender as change).  
https://www.blockchain.com/charts/estimated-transaction-volume  


```{r Estimated Transaction Value, echo=FALSE}
acf(bc[bc$phase==1,]$etrav, lag.max=30)
acf(bc[bc$phase==2,]$etrav, lag.max=30)
acf(bc[bc$phase==3,]$etrav, lag.max=30)
acf(bcl[bcl$phase==1,]$letrav, lag.max=30)
acf(bcl[bcl$phase==2,]$letrav, lag.max=30)
acf(bcl[bcl$phase==3,]$letrav, lag.max=30)
acf(bcd[bcd$phase==1,]$detrav, lag.max=30)
acf(bcd[bcd$phase==2,]$detrav, lag.max=30)
acf(bcd[bcd$phase==3,]$detrav, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dletrav, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dletrav, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dletrav, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dletrav, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dletrav, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dletrav, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dletrav, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dletrav, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dletrav, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$etrav)[[1]], w_adf.test(bcl[bcl$phase==1,]$letrav)[[1]], w_adf.test(bcd[bcd$phase==1,]$detrav)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dletrav)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$etrav)[[1]], w_adf.test(bcl[bcl$phase==2,]$letrav)[[1]], w_adf.test(bcd[bcd$phase==2,]$detrav)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dletrav)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$etrav)[[1]], w_adf.test(bcl[bcl$phase==3,]$letrav)[[1]], w_adf.test(bcd[bcd$phase==3,]$detrav)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dletrav)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$etrav)[[4]], w_adf.test(bcl[bcl$phase==1,]$letrav)[[4]], w_adf.test(bcd[bcd$phase==1,]$detrav)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dletrav)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$etrav)[[4]], w_adf.test(bcl[bcl$phase==2,]$letrav)[[4]], w_adf.test(bcd[bcd$phase==2,]$detrav)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dletrav)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$etrav)[[4]], w_adf.test(bcl[bcl$phase==3,]$letrav)[[4]], w_adf.test(bcd[bcd$phase==3,]$detrav)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dletrav)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```


### Total Output Volume

The total value of all transaction outputs per day. This includes coins which were returned to the sender as change.  
https://www.blockchain.com/charts/output-volume  


```{r Total Output Volume, echo=FALSE}
acf(bc[bc$phase==1,]$toutv, lag.max=30)
acf(bc[bc$phase==2,]$toutv, lag.max=30)
acf(bc[bc$phase==3,]$toutv, lag.max=30)
acf(bcl[bcl$phase==1,]$ltoutv, lag.max=30)
acf(bcl[bcl$phase==2,]$ltoutv, lag.max=30)
acf(bcl[bcl$phase==3,]$ltoutv, lag.max=30)
acf(bcd[bcd$phase==1,]$dtoutv, lag.max=30)
acf(bcd[bcd$phase==2,]$dtoutv, lag.max=30)
acf(bcd[bcd$phase==3,]$dtoutv, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dltoutv, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dltoutv, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dltoutv, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dltoutv, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dltoutv, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dltoutv, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dltoutv, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dltoutv, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dltoutv, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$toutv)[[1]], w_adf.test(bcl[bcl$phase==1,]$ltoutv)[[1]], w_adf.test(bcd[bcd$phase==1,]$dtoutv)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dltoutv)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$toutv)[[1]], w_adf.test(bcl[bcl$phase==2,]$ltoutv)[[1]], w_adf.test(bcd[bcd$phase==2,]$dtoutv)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dltoutv)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$toutv)[[1]], w_adf.test(bcl[bcl$phase==3,]$ltoutv)[[1]], w_adf.test(bcd[bcd$phase==3,]$dtoutv)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dltoutv)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$toutv)[[4]], w_adf.test(bcl[bcl$phase==1,]$ltoutv)[[4]], w_adf.test(bcd[bcd$phase==1,]$dtoutv)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dltoutv)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$toutv)[[4]], w_adf.test(bcl[bcl$phase==2,]$ltoutv)[[4]], w_adf.test(bcd[bcd$phase==2,]$dtoutv)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dltoutv)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$toutv)[[4]], w_adf.test(bcl[bcl$phase==3,]$ltoutv)[[4]], w_adf.test(bcd[bcd$phase==3,]$dtoutv)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dltoutv)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```
 

### New bitcoin

Bitcoins in circulation  
The total number of bitcoins that have already been mined; in other words, the current supply of bitcoins on the network.  
https://www.blockchain.com/charts/total-bitcoins?timespan=all  


```{r New Bitcoin, echo=FALSE}
acf(bc[bc$phase==1,]$newbc, lag.max=30)
acf(bc[bc$phase==2,]$newbc, lag.max=30)
acf(bc[bc$phase==3,]$newbc, lag.max=30)
acf(bcl[bcl$phase==1,]$lnewbc, lag.max=30)
acf(bcl[bcl$phase==2,]$lnewbc, lag.max=30)
acf(bcl[bcl$phase==3,]$lnewbc, lag.max=30)
acf(bcd[bcd$phase==1,]$dnewbc, lag.max=30)
acf(bcd[bcd$phase==2,]$dnewbc, lag.max=30)
acf(bcd[bcd$phase==3,]$dnewbc, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dlnewbc, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dlnewbc, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dlnewbc, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dlnewbc, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dlnewbc, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dlnewbc, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dlnewbc, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dlnewbc, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dlnewbc, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$newbc)[[1]], w_adf.test(bcl[bcl$phase==1,]$lnewbc)[[1]], w_adf.test(bcd[bcd$phase==1,]$dnewbc)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dlnewbc)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$newbc)[[1]], w_adf.test(bcl[bcl$phase==2,]$lnewbc)[[1]], w_adf.test(bcd[bcd$phase==2,]$dnewbc)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dlnewbc)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$newbc)[[1]], w_adf.test(bcl[bcl$phase==3,]$lnewbc)[[1]], w_adf.test(bcd[bcd$phase==3,]$dnewbc)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dlnewbc)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$newbc)[[4]], w_adf.test(bcl[bcl$phase==1,]$lnewbc)[[4]], w_adf.test(bcd[bcd$phase==1,]$dnewbc)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dlnewbc)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$newbc)[[4]], w_adf.test(bcl[bcl$phase==2,]$lnewbc)[[4]], w_adf.test(bcd[bcd$phase==2,]$dnewbc)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dlnewbc)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$newbc)[[4]], w_adf.test(bcl[bcl$phase==3,]$lnewbc)[[4]], w_adf.test(bcd[bcd$phase==3,]$dnewbc)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dlnewbc)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```
 

### Market Price (USD)

Average USD market price across major bitcoin exchanges.  
https://www.blockchain.com/charts/market-price  

ROCの自己相関の検定で、p値が大きく棄却できない → 自己相関がなさそう  

```{r Market Price (USD), echo=FALSE}
acf(bc[bc$phase==1,]$mkpru, lag.max=30)
acf(bc[bc$phase==2,]$mkpru, lag.max=30)
acf(bc[bc$phase==3,]$mkpru, lag.max=30)
acf(bcl[bcl$phase==1,]$lmkpru, lag.max=30)
acf(bcl[bcl$phase==2,]$lmkpru, lag.max=30)
acf(bcl[bcl$phase==3,]$lmkpru, lag.max=30)
acf(bcd[bcd$phase==1,]$dmkpru, lag.max=30)
acf(bcd[bcd$phase==2,]$dmkpru, lag.max=30)
acf(bcd[bcd$phase==3,]$dmkpru, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dlmkpru, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dlmkpru, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dlmkpru, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dlmkpru, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dlmkpru, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dlmkpru, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dlmkpru, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dlmkpru, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dlmkpru, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$mkpru)[[1]], w_adf.test(bcl[bcl$phase==1,]$lmkpru)[[1]], w_adf.test(bcd[bcd$phase==1,]$dmkpru)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dlmkpru)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$mkpru)[[1]], w_adf.test(bcl[bcl$phase==2,]$lmkpru)[[1]], w_adf.test(bcd[bcd$phase==2,]$dmkpru)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dlmkpru)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$mkpru)[[1]], w_adf.test(bcl[bcl$phase==3,]$lmkpru)[[1]], w_adf.test(bcd[bcd$phase==3,]$dmkpru)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dlmkpru)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$mkpru)[[4]], w_adf.test(bcl[bcl$phase==1,]$lmkpru)[[4]], w_adf.test(bcd[bcd$phase==1,]$dmkpru)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dlmkpru)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$mkpru)[[4]], w_adf.test(bcl[bcl$phase==2,]$lmkpru)[[4]], w_adf.test(bcd[bcd$phase==2,]$dmkpru)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dlmkpru)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$mkpru)[[4]], w_adf.test(bcl[bcl$phase==3,]$lmkpru)[[4]], w_adf.test(bcd[bcd$phase==3,]$dmkpru)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dlmkpru)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```
 

### Total Transaction Fees

The total value of all transaction fees paid to miners (not including the coinbase value of block rewards).  
https://www.blockchain.com/charts/transaction-fees  


```{r Total Transaction Fees, echo=FALSE}
acf(bc[bc$phase==1,]$trfee, lag.max=30)
acf(bc[bc$phase==2,]$trfee, lag.max=30)
acf(bc[bc$phase==3,]$trfee, lag.max=30)
acf(bcl[bcl$phase==1,]$ltrfee, lag.max=30)
acf(bcl[bcl$phase==2,]$ltrfee, lag.max=30)
acf(bcl[bcl$phase==3,]$ltrfee, lag.max=30)
acf(bcd[bcd$phase==1,]$dtrfee, lag.max=30)
acf(bcd[bcd$phase==2,]$dtrfee, lag.max=30)
acf(bcd[bcd$phase==3,]$dtrfee, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dltrfee, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dltrfee, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dltrfee, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dltrfee, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dltrfee, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dltrfee, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dltrfee, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dltrfee, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dltrfee, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$trfee)[[1]], w_adf.test(bcl[bcl$phase==1,]$ltrfee)[[1]], w_adf.test(bcd[bcd$phase==1,]$dtrfee)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dltrfee)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$trfee)[[1]], w_adf.test(bcl[bcl$phase==2,]$ltrfee)[[1]], w_adf.test(bcd[bcd$phase==2,]$dtrfee)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dltrfee)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$trfee)[[1]], w_adf.test(bcl[bcl$phase==3,]$ltrfee)[[1]], w_adf.test(bcd[bcd$phase==3,]$dtrfee)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dltrfee)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$trfee)[[4]], w_adf.test(bcl[bcl$phase==1,]$ltrfee)[[4]], w_adf.test(bcd[bcd$phase==1,]$dtrfee)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dltrfee)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$trfee)[[4]], w_adf.test(bcl[bcl$phase==2,]$ltrfee)[[4]], w_adf.test(bcd[bcd$phase==2,]$dtrfee)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dltrfee)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$trfee)[[4]], w_adf.test(bcl[bcl$phase==3,]$ltrfee)[[4]], w_adf.test(bcd[bcd$phase==3,]$dtrfee)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dltrfee)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```
 

### Miners Revenue

Total value of coinbase block rewards and transaction fees paid to miners.  
https://www.blockchain.com/charts/miners-revenue  


```{r Miners Revenue, echo=FALSE}
acf(bc[bc$phase==1,]$mirev, lag.max=30)
acf(bc[bc$phase==2,]$mirev, lag.max=30)
acf(bc[bc$phase==3,]$mirev, lag.max=30)
acf(bcl[bcl$phase==1,]$lmirev, lag.max=30)
acf(bcl[bcl$phase==2,]$lmirev, lag.max=30)
acf(bcl[bcl$phase==3,]$lmirev, lag.max=30)
acf(bcd[bcd$phase==1,]$dmirev, lag.max=30)
acf(bcd[bcd$phase==2,]$dmirev, lag.max=30)
acf(bcd[bcd$phase==3,]$dmirev, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dlmirev, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dlmirev, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dlmirev, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dlmirev, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dlmirev, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dlmirev, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dlmirev, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dlmirev, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dlmirev, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$mirev)[[1]], w_adf.test(bcl[bcl$phase==1,]$lmirev)[[1]], w_adf.test(bcd[bcd$phase==1,]$dmirev)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dlmirev)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$mirev)[[1]], w_adf.test(bcl[bcl$phase==2,]$lmirev)[[1]], w_adf.test(bcd[bcd$phase==2,]$dmirev)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dlmirev)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$mirev)[[1]], w_adf.test(bcl[bcl$phase==3,]$lmirev)[[1]], w_adf.test(bcd[bcd$phase==3,]$dmirev)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dlmirev)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$mirev)[[4]], w_adf.test(bcl[bcl$phase==1,]$lmirev)[[4]], w_adf.test(bcd[bcd$phase==1,]$dmirev)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dlmirev)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$mirev)[[4]], w_adf.test(bcl[bcl$phase==2,]$lmirev)[[4]], w_adf.test(bcd[bcd$phase==2,]$dmirev)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dlmirev)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$mirev)[[4]], w_adf.test(bcl[bcl$phase==3,]$lmirev)[[4]], w_adf.test(bcd[bcd$phase==3,]$dmirev)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dlmirev)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```
 

### Difficulty

A relative measure of how difficult it is to find a new block. The difficulty is adjusted periodically as a function of how much hashing power has been deployed by the network of miners.  
https://www.blockchain.com/charts/difficulty  


```{r Difficulty, echo=FALSE}
acf(bc[bc$phase==1,]$diff, lag.max=30)
acf(bc[bc$phase==2,]$diff, lag.max=30)
acf(bc[bc$phase==3,]$diff, lag.max=30)
acf(bcl[bcl$phase==1,]$ldiff, lag.max=30)
acf(bcl[bcl$phase==2,]$ldiff, lag.max=30)
acf(bcl[bcl$phase==3,]$ldiff, lag.max=30)
acf(bcd[bcd$phase==1,]$ddiff, lag.max=30)
acf(bcd[bcd$phase==2,]$ddiff, lag.max=30)
acf(bcd[bcd$phase==3,]$ddiff, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dldiff, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dldiff, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dldiff, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dldiff, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dldiff, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dldiff, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dldiff, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dldiff, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dldiff, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$diff)[[1]], w_adf.test(bcl[bcl$phase==1,]$ldiff)[[1]], w_adf.test(bcd[bcd$phase==1,]$ddiff)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dldiff)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$diff)[[1]], w_adf.test(bcl[bcl$phase==2,]$ldiff)[[1]], w_adf.test(bcd[bcd$phase==2,]$ddiff)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dldiff)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$diff)[[1]], w_adf.test(bcl[bcl$phase==3,]$ldiff)[[1]], w_adf.test(bcd[bcd$phase==3,]$ddiff)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dldiff)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$diff)[[4]], w_adf.test(bcl[bcl$phase==1,]$ldiff)[[4]], w_adf.test(bcd[bcd$phase==1,]$ddiff)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dldiff)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$diff)[[4]], w_adf.test(bcl[bcl$phase==2,]$ldiff)[[4]], w_adf.test(bcd[bcd$phase==2,]$ddiff)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dldiff)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$diff)[[4]], w_adf.test(bcl[bcl$phase==3,]$ldiff)[[4]], w_adf.test(bcd[bcd$phase==3,]$ddiff)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dldiff)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```


### Median Confirmation Time

The median time for a transaction to be accepted into a mined block and added to the public ledger (note: only includes transactions with miner fees).  
https://www.blockchain.com/charts/median-confirmation-time  


```{r Median Confirmation Time, echo=FALSE}
bc_om_1 <- na.omit(bc[bc$phase==1,]$atrct)
bc_om_2 <- na.omit(bc[bc$phase==2,]$atrct)
bc_om_3 <- na.omit(bc[bc$phase==3,]$atrct)
bcl_om_1 <- na.omit(bcl[bcl$phase==1,]$latrct)
bcl_om_2 <- na.omit(bcl[bcl$phase==2,]$latrct)
bcl_om_3 <- na.omit(bcl[bcl$phase==3,]$latrct)
bcd_om_1 <- na.omit(bcd[bcd$phase==1,]$datrct)
bcd_om_2 <- na.omit(bcd[bcd$phase==2,]$datrct)
bcd_om_3 <- na.omit(bcd[bcd$phase==3,]$datrct)
bcdl_om_1 <- na.omit(bcdl[bcdl$phase==1,]$dlatrct)
bcdl_om_2 <- na.omit(bcdl[bcdl$phase==2,]$dlatrct)
bcdl_om_3 <- na.omit(bcdl[bcdl$phase==3,]$dlatrct)

acf(bc_om_1, lag.max=30)
acf(bc_om_2, lag.max=30)
acf(bc_om_3, lag.max=30)
acf(bcl_om_1, lag.max=30)
acf(bcl_om_2, lag.max=30)
acf(bcl_om_3, lag.max=30)
acf(bcd_om_1, lag.max=30)
acf(bcd_om_2, lag.max=30)
acf(bcd_om_3, lag.max=30)
acf(bcdl_om_1, lag.max=30)
acf(bcdl_om_2, lag.max=30)
acf(bcdl_om_3, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl_om_1, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl_om_2, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl_om_3, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl_om_1, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl_om_2, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl_om_3, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc_om_1)[[1]], w_adf.test(bcl_om_1)[[1]], w_adf.test(bcd_om_1)[[1]], w_adf.test(bcdl_om_1)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc_om_2)[[1]], w_adf.test(bcl_om_2)[[1]], w_adf.test(bcd_om_2)[[1]], w_adf.test(bcdl_om_2)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc_om_3)[[1]], w_adf.test(bcl_om_3)[[1]], w_adf.test(bcd_om_3)[[1]], w_adf.test(bcdl_om_3)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc_om_1)[[4]], w_adf.test(bcl_om_1)[[4]], w_adf.test(bcd_om_1)[[4]], w_adf.test(bcdl_om_1)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc_om_2)[[4]], w_adf.test(bcl_om_2)[[4]], w_adf.test(bcd_om_2)[[4]], w_adf.test(bcdl_om_2)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc_om_3)[[4]], w_adf.test(bcl_om_3)[[4]], w_adf.test(bcd_om_3)[[4]], w_adf.test(bcdl_om_3)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```


### Number Of Unique Addresses Used

The total number of unique addresses used on the Bitcoin blockchain.  
https://www.blockchain.com/charts/n-unique-addresses?timespan=all  

```{r Number Of Unique Addresses Used, echo=FALSE}
acf(bc[bc$phase==1,]$naddu, lag.max=30)
acf(bc[bc$phase==2,]$naddu, lag.max=30)
acf(bc[bc$phase==3,]$naddu, lag.max=30)
acf(bcl[bcl$phase==1,]$lnaddu, lag.max=30)
acf(bcl[bcl$phase==2,]$lnaddu, lag.max=30)
acf(bcl[bcl$phase==3,]$lnaddu, lag.max=30)
acf(bcd[bcd$phase==1,]$dnaddu, lag.max=30)
acf(bcd[bcd$phase==2,]$dnaddu, lag.max=30)
acf(bcd[bcd$phase==3,]$dnaddu, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dlnaddu, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dlnaddu, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dlnaddu, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dlnaddu, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dlnaddu, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dlnaddu, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dlnaddu, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dlnaddu, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dlnaddu, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$naddu)[[1]], w_adf.test(bcl[bcl$phase==1,]$lnaddu)[[1]], w_adf.test(bcd[bcd$phase==1,]$dnaddu)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dlnaddu)[[1]])
names(stats_1) <- c("RAW", "LOG", "naddu", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$naddu)[[1]], w_adf.test(bcl[bcl$phase==2,]$lnaddu)[[1]], w_adf.test(bcd[bcd$phase==2,]$dnaddu)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dlnaddu)[[1]])
names(stats_2) <- c("RAW", "LOG", "naddu", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$naddu)[[1]], w_adf.test(bcl[bcl$phase==3,]$lnaddu)[[1]], w_adf.test(bcd[bcd$phase==3,]$dnaddu)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dlnaddu)[[1]])
names(stats_3) <- c("RAW", "LOG", "naddu", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$naddu)[[4]], w_adf.test(bcl[bcl$phase==1,]$lnaddu)[[4]], w_adf.test(bcd[bcd$phase==1,]$dnaddu)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dlnaddu)[[4]])
names(pv_1) <- c("RAW", "LOG", "naddu", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$naddu)[[4]], w_adf.test(bcl[bcl$phase==2,]$lnaddu)[[4]], w_adf.test(bcd[bcd$phase==2,]$dnaddu)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dlnaddu)[[4]])
names(pv_2) <- c("RAW", "LOG", "naddu", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$naddu)[[4]], w_adf.test(bcl[bcl$phase==3,]$lnaddu)[[4]], w_adf.test(bcd[bcd$phase==3,]$dnaddu)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dlnaddu)[[4]])
names(pv_3) <- c("RAW", "LOG", "naddu", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```
 

### Average Block Size

The average block size in MB.  
https://www.blockchain.com/charts/avg-block-size?timespan=all  


```{r Average Block Size, echo=FALSE}
acf(bc[bc$phase==1,]$avbls, lag.max=30)
acf(bc[bc$phase==2,]$avbls, lag.max=30)
acf(bc[bc$phase==3,]$avbls, lag.max=30)
acf(bcl[bcl$phase==1,]$lavbls, lag.max=30)
acf(bcl[bcl$phase==2,]$lavbls, lag.max=30)
acf(bcl[bcl$phase==3,]$lavbls, lag.max=30)
acf(bcd[bcd$phase==1,]$davbls, lag.max=30)
acf(bcd[bcd$phase==2,]$davbls, lag.max=30)
acf(bcd[bcd$phase==3,]$davbls, lag.max=30)
acf(bcdl[bcdl$phase==1,]$dlavbls, lag.max=30)
acf(bcdl[bcdl$phase==2,]$dlavbls, lag.max=30)
acf(bcdl[bcdl$phase==3,]$dlavbls, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl[bcdl$phase==1,]$dlavbls, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl[bcdl$phase==2,]$dlavbls, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl[bcdl$phase==3,]$dlavbls, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl[bcdl$phase==1,]$dlavbls, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl[bcdl$phase==2,]$dlavbls, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl[bcdl$phase==3,]$dlavbls, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc[bc$phase==1,]$avbls)[[1]], w_adf.test(bcl[bcl$phase==1,]$lavbls)[[1]], w_adf.test(bcd[bcd$phase==1,]$davbls)[[1]], w_adf.test(bcdl[bcdl$phase==1,]$dlavbls)[[1]])
names(stats_1) <- c("RAW", "LOG", "avbls", "ROC")
stats_2 <- c(w_adf.test(bc[bc$phase==2,]$avbls)[[1]], w_adf.test(bcl[bcl$phase==2,]$lavbls)[[1]], w_adf.test(bcd[bcd$phase==2,]$davbls)[[1]], w_adf.test(bcdl[bcdl$phase==2,]$dlavbls)[[1]])
names(stats_2) <- c("RAW", "LOG", "avbls", "ROC")
stats_3 <- c(w_adf.test(bc[bc$phase==3,]$avbls)[[1]], w_adf.test(bcl[bcl$phase==3,]$lavbls)[[1]], w_adf.test(bcd[bcd$phase==3,]$davbls)[[1]], w_adf.test(bcdl[bcdl$phase==3,]$dlavbls)[[1]])
names(stats_3) <- c("RAW", "LOG", "avbls", "ROC")
pv_1 <- c(w_adf.test(bc[bc$phase==1,]$avbls)[[4]], w_adf.test(bcl[bcl$phase==1,]$lavbls)[[4]], w_adf.test(bcd[bcd$phase==1,]$davbls)[[4]], w_adf.test(bcdl[bcdl$phase==1,]$dlavbls)[[4]])
names(pv_1) <- c("RAW", "LOG", "avbls", "ROC")
pv_2 <- c(w_adf.test(bc[bc$phase==2,]$avbls)[[4]], w_adf.test(bcl[bcl$phase==2,]$lavbls)[[4]], w_adf.test(bcd[bcd$phase==2,]$davbls)[[4]], w_adf.test(bcdl[bcdl$phase==2,]$dlavbls)[[4]])
names(pv_2) <- c("RAW", "LOG", "avbls", "ROC")
pv_3 <- c(w_adf.test(bc[bc$phase==3,]$avbls)[[4]], w_adf.test(bcl[bcl$phase==3,]$lavbls)[[4]], w_adf.test(bcd[bcd$phase==3,]$davbls)[[4]], w_adf.test(bcdl[bcdl$phase==3,]$dlavbls)[[4]])
names(pv_3) <- c("RAW", "LOG", "avbls", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```


### Days Destroyed

A non-cumulative version of Bitcoin Days Destroyed.  
https://www.quandl.com/data/BCHAIN/BCDDE-Bitcoin-Days-Destroyed  


```{r Days Destroyed, echo=FALSE}
bc_om_1 <- na.omit(bc[bc$phase==1,]$bcdde)
bc_om_2 <- na.omit(bc[bc$phase==2,]$bcdde)
bc_om_3 <- na.omit(bc[bc$phase==3,]$bcdde)
bcl_om_1 <- na.omit(bcl[bcl$phase==1,]$lbcdde)
bcl_om_2 <- na.omit(bcl[bcl$phase==2,]$lbcdde)
bcl_om_3 <- na.omit(bcl[bcl$phase==3,]$lbcdde)
bcd_om_1 <- na.omit(bcd[bcd$phase==1,]$dbcdde)
bcd_om_2 <- na.omit(bcd[bcd$phase==2,]$dbcdde)
bcd_om_3 <- na.omit(bcd[bcd$phase==3,]$dbcdde)
bcdl_om_1 <- na.omit(bcdl[bcdl$phase==1,]$dlbcdde)
bcdl_om_2 <- na.omit(bcdl[bcdl$phase==2,]$dlbcdde)
bcdl_om_3 <- na.omit(bcdl[bcdl$phase==3,]$dlbcdde)

acf(bc_om_1, lag.max=30)
acf(bc_om_2, lag.max=30)
acf(bc_om_3, lag.max=30)
acf(bcl_om_1, lag.max=30)
acf(bcl_om_2, lag.max=30)
acf(bcl_om_3, lag.max=30)
acf(bcd_om_1, lag.max=30)
acf(bcd_om_2, lag.max=30)
acf(bcd_om_3, lag.max=30)
acf(bcdl_om_1, lag.max=30)
acf(bcdl_om_2, lag.max=30)
acf(bcdl_om_3, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl_om_1, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl_om_2, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl_om_3, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl_om_1, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl_om_2, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl_om_3, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc_om_1)[[1]], w_adf.test(bcl_om_1)[[1]], w_adf.test(bcd_om_1)[[1]], w_adf.test(bcdl_om_1)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc_om_2)[[1]], w_adf.test(bcl_om_2)[[1]], w_adf.test(bcd_om_2)[[1]], w_adf.test(bcdl_om_2)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc_om_3)[[1]], w_adf.test(bcl_om_3)[[1]], w_adf.test(bcd_om_3)[[1]], w_adf.test(bcdl_om_3)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc_om_1)[[4]], w_adf.test(bcl_om_1)[[4]], w_adf.test(bcd_om_1)[[4]], w_adf.test(bcdl_om_1)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc_om_2)[[4]], w_adf.test(bcl_om_2)[[4]], w_adf.test(bcd_om_2)[[4]], w_adf.test(bcdl_om_2)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc_om_3)[[4]], w_adf.test(bcl_om_3)[[4]], w_adf.test(bcd_om_3)[[4]], w_adf.test(bcdl_om_3)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```


### Hash Rate

The estimated number of tera hashes per second (trillions of hashes per second) the Bitcoin network is performing.  
https://www.blockchain.com/charts/hash-rate  


```{r Hash Rate, echo=FALSE}
bc_om_1 <- na.omit(bc[bc$phase==1,]$hrate)
bc_om_2 <- na.omit(bc[bc$phase==2,]$hrate)
bc_om_3 <- na.omit(bc[bc$phase==3,]$hrate)
bcl_om_1 <- na.omit(bcl[bcl$phase==1,]$lhrate)
bcl_om_2 <- na.omit(bcl[bcl$phase==2,]$lhrate)
bcl_om_3 <- na.omit(bcl[bcl$phase==3,]$lhrate)
bcd_om_1 <- na.omit(bcd[bcd$phase==1,]$dhrate)
bcd_om_2 <- na.omit(bcd[bcd$phase==2,]$dhrate)
bcd_om_3 <- na.omit(bcd[bcd$phase==3,]$dhrate)
bcdl_om_1 <- na.omit(bcdl[bcdl$phase==1,]$dlhrate)
bcdl_om_2 <- na.omit(bcdl[bcdl$phase==2,]$dlhrate)
bcdl_om_3 <- na.omit(bcdl[bcdl$phase==3,]$dlhrate)

acf(bc_om_1, lag.max=30)
acf(bc_om_2, lag.max=30)
acf(bc_om_3, lag.max=30)
acf(bcl_om_1, lag.max=30)
acf(bcl_om_2, lag.max=30)
acf(bcl_om_3, lag.max=30)
acf(bcd_om_1, lag.max=30)
acf(bcd_om_2, lag.max=30)
acf(bcd_om_3, lag.max=30)
acf(bcdl_om_1, lag.max=30)
acf(bcdl_om_2, lag.max=30)
acf(bcdl_om_3, lag.max=30)

stats_1 <- c(); for (i in 1:10) stats_1 <- append(stats_1, Box.test(bcdl_om_1, lag=i, type="Ljung-Box")[[1]])
names(stats_1) <- 1:10
stats_2 <- c(); for (i in 1:10) stats_2 <- append(stats_2, Box.test(bcdl_om_2, lag=i, type="Ljung-Box")[[1]])
names(stats_2) <- 1:10
stats_3 <- c(); for (i in 1:10) stats_3 <- append(stats_3, Box.test(bcdl_om_3, lag=i, type="Ljung-Box")[[1]])
names(stats_3) <- 1:10
pv_1 <- c(); for (i in 1:10) pv_1 <- append(pv_1, Box.test(bcdl_om_1, lag=100, type="Ljung-Box")[[3]])
names(pv_1) <- 1:10
pv_2 <- c(); for (i in 1:10) pv_2 <- append(pv_2, Box.test(bcdl_om_2, lag=100, type="Ljung-Box")[[3]])
names(pv_2) <- 1:10
pv_3 <- c(); for (i in 1:10) pv_3 <- append(pv_3, Box.test(bcdl_om_3, lag=100, type="Ljung-Box")[[3]])
names(pv_3) <- 1:10
ljung_box <- t(data.frame("Qm_1"=stats_1, "p-value_1"=pv_1, "Qm_2"=stats_2, "p-value_2"=pv_2,"Qm_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(ljung_box, caption="Ljung-Box"))

stats_1 <- c(w_adf.test(bc_om_1)[[1]], w_adf.test(bcl_om_1)[[1]], w_adf.test(bcd_om_1)[[1]], w_adf.test(bcdl_om_1)[[1]])
names(stats_1) <- c("RAW", "LOG", "DIFF", "ROC")
stats_2 <- c(w_adf.test(bc_om_2)[[1]], w_adf.test(bcl_om_2)[[1]], w_adf.test(bcd_om_2)[[1]], w_adf.test(bcdl_om_2)[[1]])
names(stats_2) <- c("RAW", "LOG", "DIFF", "ROC")
stats_3 <- c(w_adf.test(bc_om_3)[[1]], w_adf.test(bcl_om_3)[[1]], w_adf.test(bcd_om_3)[[1]], w_adf.test(bcdl_om_3)[[1]])
names(stats_3) <- c("RAW", "LOG", "DIFF", "ROC")
pv_1 <- c(w_adf.test(bc_om_1)[[4]], w_adf.test(bcl_om_1)[[4]], w_adf.test(bcd_om_1)[[4]], w_adf.test(bcdl_om_1)[[4]])
names(pv_1) <- c("RAW", "LOG", "DIFF", "ROC")
pv_2 <- c(w_adf.test(bc_om_2)[[4]], w_adf.test(bcl_om_2)[[4]], w_adf.test(bcd_om_2)[[4]], w_adf.test(bcdl_om_2)[[4]])
names(pv_2) <- c("RAW", "LOG", "DIFF", "ROC")
pv_3 <- c(w_adf.test(bc_om_3)[[4]], w_adf.test(bcl_om_3)[[4]], w_adf.test(bcd_om_3)[[4]], w_adf.test(bcdl_om_3)[[4]])
names(pv_3) <- c("RAW", "LOG", "DIFF", "ROC")
a_dicky_fuller <- t(data.frame("DF_1"=stats_1, "p-value_1"=pv_1, "DF_2"=stats_2, "p-value_2"=pv_2, "DF_3"=stats_3, "p-value_3"=pv_3))
w_kable_styling(kable(a_dicky_fuller, caption="ADF-test"))
```
  

## 基本統計量

### 標本平均


```{r Mean, echo=FALSE}
bc_mean_1 <- apply(bc[bc$phase==1,2:15], 2, mean, na.rm=TRUE)
bc_mean_2 <- apply(bc[bc$phase==2,2:15], 2, mean, na.rm=TRUE)
bc_mean_3 <- apply(bc[bc$phase==3,2:15], 2, mean, na.rm=TRUE)
bcd_mean_1 <- apply(bcd[bcd$phase==1,2:15], 2, mean, na.rm=TRUE)
bcd_mean_2 <- apply(bcd[bcd$phase==2,2:15], 2, mean, na.rm=TRUE)
bcd_mean_3 <- apply(bcd[bcd$phase==3,2:15], 2, mean, na.rm=TRUE)
bcl_mean_1 <- apply(bcl[bcl$phase==1,2:15], 2, mean, na.rm=TRUE)
bcl_mean_2 <- apply(bcl[bcl$phase==2,2:15], 2, mean, na.rm=TRUE)
bcl_mean_3 <- apply(bcl[bcl$phase==3,2:15], 2, mean, na.rm=TRUE)
bcdl_mean_1 <- apply(bcdl[bcdl$phase==1,2:15], 2, mean, na.rm=TRUE)
bcdl_mean_2 <- apply(bcdl[bcdl$phase==2,2:15], 2, mean, na.rm=TRUE)
bcdl_mean_3 <- apply(bcdl[bcdl$phase==3,2:15], 2, mean, na.rm=TRUE)
mean_table <- data.frame(BC_1=bc_mean_1, BC_2=bc_mean_2, BC_3=bc_mean_3, BCD_1=bcd_mean_1, BCD_2=bcd_mean_2, BCD_3=bcd_mean_3, BCL_1=bcl_mean_1, BCL_2=bcl_mean_2, BCL_3=bcl_mean_3, BCDL_1=bcdl_mean_1, BCDL_2=bcdl_mean_2, BCDL_3=bcdl_mean_3)
w_kable_styling(kable(mean_table, caption="Mean"))
```


### 標本分散


```{r Variance, echo=FALSE}
variance <- function(x) var(x)*(length(x)-1)/length(x)
bc_variance_1 <- apply(na.omit(bc[bc$phase==1,2:15]), 2, variance)
bc_variance_2 <- apply(na.omit(bc[bc$phase==2,2:15]), 2, variance)
bc_variance_3 <- apply(na.omit(bc[bc$phase==3,2:15]), 2, variance)
bcd_variance_1 <- apply(na.omit(bcd[bcd$phase==1,2:15]), 2, variance)
bcd_variance_2 <- apply(na.omit(bcd[bcd$phase==2,2:15]), 2, variance)
bcd_variance_3 <- apply(na.omit(bcd[bcd$phase==3,2:15]), 2, variance)
bcl_variance_1 <- apply(na.omit(bcl[bcl$phase==1,2:15]), 2, variance)
bcl_variance_2 <- apply(na.omit(bcl[bcl$phase==2,2:15]), 2, variance)
bcl_variance_3 <- apply(na.omit(bcl[bcl$phase==3,2:15]), 2, variance)
bcdl_variance_1 <- apply(na.omit(bcdl[bcdl$phase==1,2:15]), 2, variance)
bcdl_variance_2 <- apply(na.omit(bcdl[bcdl$phase==2,2:15]), 2, variance)
bcdl_variance_3 <- apply(na.omit(bcdl[bcdl$phase==3,2:15]), 2, variance)
variance_table <- data.frame(BC_1=bc_variance_1, BC_2=bc_variance_2, BC_3=bc_variance_3, BCD_1=bcd_variance_1, BCD_2=bcd_variance_2, BCD_3=bcd_variance_3, BCL_1=bcl_variance_1, BCL_2=bcl_variance_2, BCL_3=bcl_variance_3, BCDL_1=bcdl_variance_1, BCDL_2=bcdl_variance_2, BCDL_3=bcdl_variance_3)
w_kable_styling(kable(variance_table, caption="Variance"))
```

### 考察

phaseによって平均・分散がかなり異なっているので、やはり分けて分析した方が良さそう  


## VAR

phase 2 3 のモデルの方が説明力がある。  
-> 差分をどうやって測るか？  
-> 共和分関係をまだ調べていない  
-> 一旦参考論文に立ち返るのはありかも  

```{r VAR, echo=FALSE}
VARselect(ts(na.omit(bcdl[bcdl$phase==1,2:16])), lag.max = 10)
VARselect(ts(na.omit(bcdl[bcdl$phase==2,2:16])), lag.max = 10)
VARselect(ts(na.omit(bcdl[bcdl$phase==3,c(2:14, 16)])), lag.max = 10)
var_model_1_aic <- VAR(ts(na.omit(bcdl[bcdl$phase==1,2:16])), p=5, type="const")
var_model_1_sic <- VAR(ts(na.omit(bcdl[bcdl$phase==1,2:16])), p=1, type="const")
var_model_2_aic <- VAR(ts(na.omit(bcdl[bcdl$phase==2,2:16])), p=6, type="const")
var_model_2_sic <- VAR(ts(na.omit(bcdl[bcdl$phase==2,2:16])), p=1, type="const")
var_model_3_aic <- VAR(ts(na.omit(bcdl[bcdl$phase==3,c(2:14, 16)])), p=6, type="const")
var_model_3_sic <- VAR(ts(na.omit(bcdl[bcdl$phase==3,c(2:14, 16)])), p=1, type="const")
summary(var_model_1_aic)
summary(var_model_1_sic)
summary(var_model_2_aic)
summary(var_model_2_sic)
summary(var_model_3_aic)
summary(var_model_3_sic)
causality(var_model_1_aic, cause = "dlexch")
causality(var_model_1_aic, cause = "dlntran")
causality(var_model_1_aic, cause = "dletrav")
causality(var_model_1_sic, cause = "dlexch")
causality(var_model_1_sic, cause = "dlntran")
causality(var_model_1_sic, cause = "dletrav")
causality(var_model_2_aic, cause = "dlexch")
causality(var_model_2_aic, cause = "dlntran")
causality(var_model_2_aic, cause = "dletrav")
causality(var_model_2_sic, cause = "dlexch")
causality(var_model_2_sic, cause = "dlntran")
causality(var_model_2_sic, cause = "dletrav")
causality(var_model_3_aic, cause = "dlexch")
causality(var_model_3_aic, cause = "dlntran")
causality(var_model_3_aic, cause = "dletrav")
causality(var_model_3_sic, cause = "dlexch")
causality(var_model_3_sic, cause = "dlntran")
causality(var_model_3_sic, cause = "dletrav")
```

### 考察

exch <- exch + ntran + avbls + bcdde
